# ComfyUI-TD

This node enables seamless data interaction between [TouchDesigner](https://derivative.ca/) (hereinafter referred to as "TD") and [ComfyUI](https://github.com/comfyanonymous/ComfyUI).

Supports real-time transmission of **images**, **videos**, and **3D models (point clouds)** generated by ComfyUI into TD.

| | | |
|:---:|:---:|:---:|
| ![](https://github.com/JiSenHua/ComfyUI-TD/blob/JiSenHua-patch-1/Image/image.gif) | ![](https://github.com/JiSenHua/ComfyUI-TD/blob/JiSenHua-patch-1/Image/Video.gif) | ![](https://github.com/JiSenHua/ComfyUI-TD/blob/JiSenHua-patch-1/Image/PointCloud.gif) |

## User Notice
- **ComfyUI-TD** nodes are ported and optimized based on [ComfyUI-Tooling-Nodes](https://github.com/Acly/comfyui-tooling-nodes/tree/main).
- **ComfyUI-TD** requires the **ComfyUI2TD.tox** component to work.  
- Please ensure that the **ComfyUI2TD.tox** component is updated to version **v_5.1.x** or later. This version features a complete code overhaul, supporting video and 3D model (point cloud) data transmission. The WebSocket interface has also been rewritten to effectively resolve issues where data (images) might not return properly under poor network conditions when using a cloud-based ComfyUI.  
- Starting from version **v_5.1.x**, the pre-configured workflows in **ComfyUI2TD.tox** use ComfyUI-TD nodes instead of [ComfyUI-Tooling-Nodes](https://github.com/Acly/comfyui-tooling-nodes/tree/main).
- Older versions of **ComfyUI2TD.tox** were developed based on the [TDComfyUI](https://github.com/olegchomp/TDComfyUI) project. Thanks to olegchomp!
- If you need to use a cloud-based ComfyUI, you can choose the [Xiangongyun](https://www.xiangongyun.com/register/YALSMH) server. A [compatible image](https://www.xiangongyun.com/image/detail/5f185465-ef11-42e5-ba21-3ee07acb5403) is ready.

---

## Usage Instructions
### Video Tutorials
- Please watch the following videos in order.
- [1. Basic Tutorial for ComfyUI2TD Plugin (Bilibili)]( https://www.bilibili.com/video/BV18t4oeNEgj/?share_source=copy_web&vd_source=3900738a289821efe0ce52f9c9fb663f)
- [2. Tutorial for Using Xiangongyun Cloud (Bilibili)](https://www.bilibili.com/video/BV1RxUyYyEeU/?share_source=copy_web&vd_source=3900738a289821efe0ce52f9c9fb663f)
- [3. New Tutorial for ComfyUI2TD_v 5.1 (In Production...)]()

---

### Installation of ComfyUI-TD Nodes
#### Method 1: (Currently Unavailable)
- Use [ComfyUI-Manager](https://github.com/ltdrdata/ComfyUI-Manager?tab=readme-ov-file) to search for **ComfyUI-TD** and directly install the nodes.

#### Method 2:
- Manual Installation: Download and extract this project, then place it in `X:\ComfyUI_windows_portable\ComfyUI\custom_nodes`.

#### Method 3:
- Install using the git clone command.
```
cd custom_nodes
git clone https://github.com/JiSenHua/ComfyUI-TD.git
```

#### Method 4:
- Use the `InjectFile` feature of the **ComfyUI2TD.tox** component to automatically inject the nodes into `X:\ComfyUI_windows_portable\ComfyUI\custom_nodes`.

---

## ComfyUI-TD Node Descriptions

| ![Hy3DtoTD Node Example](https://github.com/JiSenHua/ComfyUI-TD/blob/JiSenHua-patch-1/Image/Hy3DtoTD.png) |
|:---|
| **Hy3DtoTD** |
| - This node supports converting GLB models generated by **Hunyuan3D_V2** into point cloud data and returning them to **TD** for parsing, thereby generating corresponding CHOP components.<br>- To use this node, you need to install the [ComfyUI-Hunyuan3DWrapper](https://github.com/kijai/ComfyUI-Hunyuan3DWrapper) node.<br>- If you encounter difficulties installing [ComfyUI-Hunyuan3DWrapper](https://github.com/kijai/ComfyUI-Hunyuan3DWrapper), you can use the cloud-based [**Xiangongyun** image](https://www.xiangongyun.com/image/detail/5f185465-ef11-42e5-ba21-3ee07acb5403).<br>- The pre-configured workflow **Hunyuan3DV2_PointCloud** in **ComfyUI2TD.tox** provides a basic usage example of this node. The corresponding `.js` workflow file has been uploaded to the `workflow` folder.<br>- The latest version of [ComfyUI-Hunyuan3DWrapper](https://github.com/kijai/ComfyUI-Hunyuan3DWrapper) has converted all model workflows to `trimesh`.<br>- It is recommended to install [ComfyUI_essentials](https://github.com/cubiq/ComfyUI_essentials) to avoid errors when running pre-configured workflows.<br>- `broadcast` parameter (default off): When enabled, the generated point cloud data will be broadcast to all clients with established WebSocket connections. |

(The rest of the node descriptions follow the same format as above.)
